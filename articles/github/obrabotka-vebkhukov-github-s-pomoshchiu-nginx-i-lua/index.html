<!DOCTYPE html>
<html lang="ru"> <head><title>Обработка вебхуков GitHub с помощью Nginx и Lua | Maks live</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#00aeff"><meta name="msapplication-navbutton-color" content="#00aeff"><meta name="apple-mobile-web-app-status-bar-style" content="#00aeff"><meta name="author" content="Maks"><meta name="robots" content="index, follow"><meta name="keywords" content="article, github, lua, nginx, webhook, autodeploy"><meta name="description" content="После того как принимается pull-request и наработки кода попадают в мастер, нужно обновить сервер, выполнив на нем команды деплоя. Обычно у нас эта обязанность возложена на сервер CI TeamCity, который в случае успешного билда, мастер ветки накатывает изменения на продакшен сервера. Но иногда не нужно такое сложное взаимодействие, а достаточно просто знать факт пуша в мастер и обработать его самостоятельно. С помощью вебхуков GitHub может уведомлять о push событиях в репозитории. Но для валидации и обработки этих запросов нужен какой-либо бекенд. В этом мне помогает знакомая связка Nginx + Lua."><meta property="og:title" content="Обработка вебхуков GitHub с помощью Nginx и Lua"><meta property="og:url" content="https://maks.live/articles/github/obrabotka-vebkhukov-github-s-pomoshchiu-nginx-i-lua/"><meta property="og:site_name" content="Maks live"><meta property="og:type" content="article"><meta property="og:image" content="https://maks.live/media/luahook/lua-github.png"><meta property="og:description" content="После того как принимается pull-request и наработки кода попадают в мастер, нужно обновить сервер, выполнив на нем команды деплоя. Обычно у нас эта обязанность возложена на сервер CI TeamCity, который в случае успешного билда, мастер ветки накатывает изменения на продакшен сервера. Но иногда не нужно такое сложное взаимодействие, а достаточно просто знать факт пуша в мастер и обработать его самостоятельно. С помощью вебхуков GitHub может уведомлять о push событиях в репозитории. Но для валидации и обработки этих запросов нужен какой-либо бекенд. В этом мне помогает знакомая связка Nginx + Lua."><meta property="og:image:width" content="1280"><meta property="og:image:height" content="791"><link rel="canonical" href="https://maks.live/articles/github/obrabotka-vebkhukov-github-s-pomoshchiu-nginx-i-lua/"><link href="https://maks.live/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Maks live Atom"><link href="https://maks.live/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Maks live RSS"><link rel="stylesheet" type="text/css" href="/theme/css/bootstrap.css"><link rel="stylesheet" type="text/css" href="/theme/css/font-awesome.css"><link rel="stylesheet" type="text/css" href="/theme/css/style.css"><link rel="stylesheet" type="text/css" href="/theme/css/pygment.css"><link rel="stylesheet" type="text/css" href="/theme/css/social-likes_flat.css"><script type="text/javascript" src="/theme/js/jquery.min.js"></script><script type="text/javascript" src="/theme/js/bootstrap.min.js"></script><script type="text/javascript" src="/theme/js/social-likes.min.js"></script><link rel="stylesheet" type="text/css" href="https://maks.live/theme/css/tree.css"><link rel="stylesheet" type="text/css" href="https://maks.live/theme/css/anchorific.css"><script type="text/javascript" src="https://maks.live/theme/js/anchorific.js"></script></head> <body id="index"> <a class="forkmegithub" href="https://github.com/Samael500"> <img style="position: absolute; top: 0; right: 0; border: 0;" src="/theme/images/forkme_right_gray.png" alt="Fork me on GitHub"> </a> <div class="header"> <div class="container"> <div class="logo"> <a href="https://maks.live/"> MAKS LIVE<br><small>samael500 blog</small> </a> </div> <div class="top-menu"> <div class="search"> <script>
  (function() {
    var cx = '006263355362628034990:cuxoisonrno';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script> <form id="searchbox_006263355362628034990:cuxoisonrno" action="https://www.google.com/"> <input value="006263355362628034990:cuxoisonrno" name="cx" type="hidden"> <input value="FORID:11" name="cof" type="hidden"> <input id="q" name="q" type="text" required> <input type="submit" value> </form> </div> <span class="menu"> </span> <ul> <li> <a href="/">HOME</a></li> <li> <a href="/tag/best/">BEST</a></li> <li><a href="https://maks.live/about/">ABOUT</a></li> <div class="clearfix"></div> </ul> <div class="clearfix"></div> <script>
                $("span.menu").click(function(){
                    $(".top-menu ul").slideToggle("slow" , function(){
                    });
                });
            </script> </div> </div> </div> <div class="content"> <div class="container"> <div class="content-grids"> <div class="single-main"> <div class="col-md-9 single-grid"> <header> <h4> <a href="https://maks.live/articles/github/obrabotka-vebkhukov-github-s-pomoshchiu-nginx-i-lua/" title="Обработка вебхуков GitHub с помощью Nginx и Lua">Обработка вебхуков GitHub с помощью Nginx и&nbsp;Lua</a> Mar 20, 2017 </h4> <div class="footer art-info"> Author: <a class="url fn" href="https://maks.live/author/maks/">Maks</a> | Category: <a href="https://maks.live/category/github/">Github</a> | <a href="https://maks.live/articles/github/obrabotka-vebkhukov-github-s-pomoshchiu-nginx-i-lua/#disqus_thread">Comments</a> <br> Tags: <a href="https://maks.live/tag/github/">github</a> <a href="https://maks.live/tag/lua/">lua</a> <a href="https://maks.live/tag/nginx/">nginx</a> <a href="https://maks.live/tag/webhook/">webhook</a> <a href="https://maks.live/tag/autodeploy/">autodeploy</a> </div><div class="social-likes"> <div class="vkontakte" title="Поделиться ссылкой во Вконтакте">Вконтакте</div> <div class="twitter" data-via="samael500" title="Поделиться ссылкой в Твиттере">Twitter</div> <div class="facebook" title="Поделиться ссылкой на Фейсбуке">Facebook</div> <div class="plusone" title="Поделиться ссылкой в Google+">Google+</div> </div> </header> <article class="content"> <p>После того как принимается <code>pull-request</code> и наработки кода попадают в мастер, нужно обновить сервер, выполнив на нем команды деплоя. Обычно у нас эта обязанность возложена на сервер <code>CI TeamCity</code>, который в случае успешного билда мастер ветки накатывает изменения на продакшен сервера. Но иногда не нужно такое сложное взаимодействие, а достаточно просто знать факт пуша в мастер и обработать его самостоятельно. С помощью вебхуков <code>GitHub</code> может уведомлять о <a href="https://developer.github.com/v3/activity/events/types/#pushevent">push</a> событиях в репозитории. Но для валидации и обработки этих запросов нужен какой-либо бекенд. В этом мне помогает знакомая связка <code>Nginx</code> + <code>Lua</code>.</p> <h3 id="predvaritelnaia-nastroika"><a class="toclink" href="#predvaritelnaia-nastroika">Предварительная&nbsp;настройка</a></h3> <p>Нам понадобятся <code>Nginx</code> с модулем <a href="https://github.com/openresty/lua-nginx-module">lua-nginx-module</a>. И две дополнительные библиотеки для <code>lua</code>. Для того чтобы прочесть <code>json</code> тело запроса используем <a href="http://json.luaforge.net/">JSON4Lua</a>, а для валидации подписи <a href="http://mkottman.github.io/luacrypto/">LuaCrypto</a>. Установим их через менеджер пакетов <a href="https://luarocks.org/">luarocks</a>.</p> <div class="highlight"><pre><span></span>$ sudo luarocks install JSON4Lua
$ sudo luarocks install luacrypto
</pre></div> <p>Подробнее о том как настроить <code>Nginx</code> и <code>Lua</code> можно прочитать в <a href="https://maks.live/articles/drugoe/sobstvennoe-khranilishche-versirovannykh-vagrant-boksov-s-pomoshchiu-nginx-i-lua/#ustanovka-i-zavisimosti">статье</a>.</p> <h4 id="nash-server"><a class="toclink" href="#nash-server">Наш&nbsp;сервер</a></h4> <p>Сконфигурируем локейшн для принятия&nbsp;вебхука.</p> <div class="highlight"><pre><span></span><span class="k">server</span> <span class="p">{</span>

    <span class="c1"># ...</span>

    <span class="kn">location</span> <span class="s">/deploy</span> <span class="p">{</span>
        <span class="kn">client_body_buffer_size</span> <span class="s">3M</span><span class="p">;</span>
        <span class="kn">client_max_body_size</span>  <span class="s">3M</span><span class="p">;</span>
        <span class="kn">content_by_lua_file</span> <span class="s">/path/to/handler.lua</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div> <p>Важно установить значения <code>client_body_buffer_size</code> и <code>client_max_body_size</code> одинаковыми. Для корректного чтения тела запроса и предотвращения ошибки работы с временным&nbsp;файлом.</p> <blockquote> <p>lua entry thread aborted: runtime error: requesty body in temp file not&nbsp;supported</p> </blockquote> <h4 id="github-hooks"><a class="toclink" href="#github-hooks">GitHub&nbsp;hooks</a></h4> <p>В настройках репозитория создадим новый вебхук и направим его на наш&nbsp;локейшн.</p> <p><img alt="gh hook" class="center shadow" src="/media/luahook/gh-hook.png"></p> <h3 id="validatsiia-zaprosa"><a class="toclink" href="#validatsiia-zaprosa">Валидация&nbsp;запроса</a></h3> <p>Проверка корректности запроса. В первую очередь нужно убедиться, что запрос действительно <code>POST</code>. Сделаем это с помощью функции <a href="https://github.com/openresty/lua-nginx-module#ngxreqget_method">req.get_method</a>.</p> <div class="highlight"><pre><span></span><span class="c1">-- should be POST method</span>
<span class="kr">if</span> <span class="n">ngx</span><span class="p">.</span><span class="n">req</span><span class="p">.</span><span class="n">get_method</span><span class="p">()</span> <span class="o">~=</span> <span class="s2">&quot;POST&quot;</span> <span class="kr">then</span>
    <span class="n">ngx</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">ERR</span><span class="p">,</span> <span class="s2">&quot;wrong event request method: &quot;</span><span class="p">,</span> <span class="n">ngx</span><span class="p">.</span><span class="n">req</span><span class="p">.</span><span class="n">get_method</span><span class="p">())</span>
    <span class="kr">return</span> <span class="n">ngx</span><span class="p">.</span><span class="n">exit</span> <span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">HTTP_NOT_ALLOWED</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <p>Следующим шагом проверим, что этот запрос содержит заголовок с хук методом. Получив все заголовки с помощью функции <a href="https://github.com/openresty/lua-nginx-module#ngxreqget_headers">req.get_headers</a>.</p> <div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">event</span> <span class="o">=</span> <span class="s1">&#39;push&#39;</span>

<span class="c1">-- ...</span>

<span class="kd">local</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">ngx</span><span class="p">.</span><span class="n">req</span><span class="p">.</span><span class="n">get_headers</span><span class="p">()</span>
<span class="c1">-- with correct header</span>
<span class="kr">if</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-GitHub-Event&#39;</span><span class="p">]</span> <span class="o">~=</span> <span class="n">event</span> <span class="kr">then</span>
    <span class="n">ngx</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">ERR</span><span class="p">,</span> <span class="s2">&quot;wrong event type: &quot;</span><span class="p">,</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-GitHub-Event&#39;</span><span class="p">])</span>
    <span class="kr">return</span> <span class="n">ngx</span><span class="p">.</span><span class="n">exit</span> <span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">HTTP_NOT_ACCEPTABLE</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <p>Так как мы будем слушать вебхуки в формате <code>json</code>, проверим контент тип&nbsp;запроса.</p> <div class="highlight"><pre><span></span><span class="c1">-- should be json encoded request</span>
<span class="kr">if</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span> <span class="o">~=</span> <span class="s1">&#39;application/json&#39;</span> <span class="kr">then</span>
    <span class="n">ngx</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">ERR</span><span class="p">,</span> <span class="s2">&quot;wrong content type header: &quot;</span><span class="p">,</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">])</span>
    <span class="kr">return</span> <span class="n">ngx</span><span class="p">.</span><span class="n">exit</span> <span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">HTTP_NOT_ACCEPTABLE</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <p>По первичным признакам запрос корректный. Проанализируем тело запроса. С помощью функций <a href="https://github.com/openresty/lua-nginx-module#ngxreqread_body">req.read_body</a> и <a href="https://github.com/openresty/lua-nginx-module#ngxreqget_body_data">req.get_body_data</a>.</p> <div class="highlight"><pre><span></span><span class="c1">-- read request body</span>
<span class="n">ngx</span><span class="p">.</span><span class="n">req</span><span class="p">.</span><span class="n">read_body</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ngx</span><span class="p">.</span><span class="n">req</span><span class="p">.</span><span class="n">get_body_data</span><span class="p">()</span>

<span class="kr">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="kr">then</span>
    <span class="n">ngx</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">ERR</span><span class="p">,</span> <span class="s2">&quot;failed to get request body&quot;</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">ngx</span><span class="p">.</span><span class="n">exit</span> <span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">HTTP_BAD_REQUEST</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <p>Проверим корректность подписи запроса, которая передается в заголовке <code>X-Hub-Signature</code>, используя функцию <a href="#proverka-podpisi">verify_signature</a>.</p> <div class="highlight"><pre><span></span><span class="c1">-- validate GH signature</span>
<span class="kr">if</span> <span class="ow">not</span> <span class="n">verify_signature</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Hub-Signature&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span> <span class="kr">then</span>
    <span class="n">ngx</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">ERR</span><span class="p">,</span> <span class="s2">&quot;wrong webhook signature&quot;</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">ngx</span><span class="p">.</span><span class="n">exit</span> <span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">HTTP_FORBIDDEN</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <p>Последний шаг - убедиться, что этот <code>push</code> был в интересующей нас ветке. Разобрав тело запроса в таблицу <code>lua</code> с помощью функции <a href="http://json.luaforge.net/#json_decode">json.decode</a>.</p> <div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">branch</span> <span class="o">=</span> <span class="s1">&#39;refs/heads/master&#39;</span>

<span class="c1">-- ...</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1">-- on master branch</span>
<span class="kr">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span> <span class="o">~=</span> <span class="n">branch</span> <span class="kr">then</span>
    <span class="n">ngx</span><span class="p">.</span><span class="n">say</span><span class="p">(</span><span class="s2">&quot;Skip branch &quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">])</span>
    <span class="kr">return</span> <span class="n">ngx</span><span class="p">.</span><span class="n">exit</span> <span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">HTTP_OK</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <h4 id="proverka-podpisi"><a class="toclink" href="#proverka-podpisi">Проверка&nbsp;подписи</a></h4> <p>Для подтверждения корректности запроса, <code>GitHub</code> использует <code>HMAC</code> <code>SHA1</code> подпись и передает её в заголовке <code>X-Hub-Signature</code>, пример в <a href="https://developer.github.com/webhooks/securing/#validating-payloads-from-github">документации</a>.</p> <p>Вызовем функцию <a href="http://luacrypto.luaforge.net/0.1/luacrypto.html#usage-hmac">crypto.hmac.digest</a> и сравним её результат с полученным&nbsp;заголовком.</p> <div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">secret</span> <span class="o">=</span> <span class="s1">&#39;&lt;MY SUPER SECRET&gt;&#39;</span>

<span class="c1">-- ...</span>

<span class="kd">local</span> <span class="kr">function</span> <span class="nf">verify_signature</span> <span class="p">(</span><span class="n">hub_sign</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">sign</span> <span class="o">=</span> <span class="s1">&#39;sha1=&#39;</span> <span class="o">..</span> <span class="n">crypto</span><span class="p">.</span><span class="n">hmac</span><span class="p">.</span><span class="n">digest</span><span class="p">(</span><span class="s1">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">secret</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">hub_sign</span> <span class="o">==</span> <span class="n">sign</span>
<span class="kr">end</span>
</pre></div> <h4 id="konstantnoe-sravnenie-strok"><a class="toclink" href="#konstantnoe-sravnenie-strok">Константное сравнение&nbsp;строк</a></h4> <p>Простое сравнение строк на <code>==</code> использовать не рекомендуется, т.к. злоумышленник может провести <a href="https://en.wikipedia.org/wiki/Timing_attack">атаку по времени</a>.</p> <p>В <code>lua</code> нельзя просто так взять и обратиться к строке по индексу. Так что для удобства внедрим данную функцию в метакласс&nbsp;строки.</p> <div class="highlight"><pre><span></span><span class="nb">getmetatable</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="n">__index</span> <span class="o">=</span> <span class="kr">function</span> <span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="kr">return</span> <span class="nb">string.sub</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <p>Напишем функцию сравнения строк за &#8220;константное&#8221; время. Строки равны тогда и только тогда, когда равны&nbsp;посимвольно.</p> <div class="highlight"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">const_eq</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="c1">-- Check is string equals, constant time exec</span>
    <span class="kd">local</span> <span class="n">equal</span> <span class="o">=</span> <span class="nb">string.len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">string.len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="kr">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">math.max</span><span class="p">(</span><span class="nb">string.len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">string.len</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="kr">do</span>
        <span class="n">equal</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">and</span> <span class="n">equal</span>
    <span class="kr">end</span>
    <span class="kr">return</span> <span class="n">equal</span>
<span class="kr">end</span>
</pre></div> <h3 id="avtomaticheskii-deploi"><a class="toclink" href="#avtomaticheskii-deploi">Автоматический&nbsp;деплой</a></h3> <p>В случае, если <code>webhook</code> прошел все валидации, можно ему доверять. Через системный вызов <a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.popen">io.popen</a> выполним необходимые команды деплоя. В данном примере осуществляется простой <code>pull</code> из&nbsp;репозитория.</p> <div class="highlight"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">deploy</span> <span class="p">()</span>
    <span class="kd">local</span> <span class="n">handle</span> <span class="o">=</span> <span class="nb">io.popen</span><span class="p">(</span><span class="s2">&quot;cd /path/to/repo &amp;&amp; sudo -u username git pull&quot;</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">result</span> <span class="o">=</span> <span class="n">handle</span><span class="p">:</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;*a&quot;</span><span class="p">)</span>
    <span class="n">handle</span><span class="p">:</span><span class="n">close</span><span class="p">()</span>

    <span class="n">ngx</span><span class="p">.</span><span class="n">say</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">ngx</span><span class="p">.</span><span class="n">exit</span> <span class="p">(</span><span class="n">ngx</span><span class="p">.</span><span class="n">HTTP_OK</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div> <p>Полный пример <code>handler.lua</code> можно посмотреть в <a href="https://gist.github.com/Samael500/5dbdf6d55838f841a08eb7847ad1c926">gist</a> или вопросе на <a href="http://stackoverflow.com/a/43146712/4716629">StackOverflow</a>.</p> </article> <div class="comments"> <div id="disqus_thread"></div> <script type="text/javascript">
                    var disqus_identifier = "articles/github/obrabotka-vebkhukov-github-s-pomoshchiu-nginx-i-lua/";
                    (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//samael500.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script> </div> </div> <div class="col-md-3 content-right"> <div class="anchorific"></div> </div> </div> </div> </div> </div> <div class="footer"> <div class="container"> <p>This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.</p> <p><a href="http://github.com/samael500/w3-personal-blog/">W3 Personal Blog</a> is a flat <a href="http://getbootstrap.com/">bootstrap</a> responsive theme designed by <a href="https://w3layouts.com/personal-blog-a-blogging-category-flat-bootstrap-responsive-web-template/">W3layouts</a> ported to a pelican by <a href="http://samael500.github.io/">Samael500</a>.<p> <p>Copyrights &copy; 2015&mdash;2017 Maks live All rights reserved.</p> <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"> <img alt="Creative Commons License" style="border-width:0" src="/media/by-nc-sa.svg"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"> Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p> </div> </div> <script type="text/javascript" src="https://www.l2.io/ip.js?var=userip"></script> <script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter32194009 = new Ya.Metrika({
                    id:32194009,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true,
                    params:{'ip': userip}
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script> <noscript><div><img src="https://mc.yandex.ru/watch/32194009" style="position:absolute; left:-9999px;" alt></div></noscript> <script type="text/javascript">
    var disqus_shortname = 'samael500';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script> </body> </html>